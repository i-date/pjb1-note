# VBAのTips

## 重要度: 高

- 実行結果はCtrl+Zでは戻せない
- 無限ループは、Esc長押ししながらタスクバーのアイコン(何でも良い)で抜ける
- ショートカット: コメント化 / 非コメント化
  1. 表示→ツールバー→編集
  2. 編集ツールバー右クリック→ユーザー設定
  3. 選択したボタンの編集→名前変更(&キーで指定)→イメージとテキストを表示
- 目的のオブジェクトの調査方法
  1. マクロの記録(Excel開発タブ)
  2. ヘルプ(VBE上で対象選択→F1)
  3. オブジェクトブラウザー(F2)

## 重要度: 中

- 糖衣構文`?`: イミディエイトウインドウで、Debug.Printの代わりに使用
- `Object.Value = Object.Value`: 数式を値に変換
- 変数代入
  - Set: オブジェクトを代入する時
  - Let: リテラル(値)を代入する時(Letは省略される)
- 引数全体を括弧で囲む必要があるとき: 関数やメソッドの戻り値を変数に代入、または利用する場合
- マクロ実行中にセル範囲を選択してもらう→`Application.InputBox(表示文字列, Type:=8)`(`Type:=8`はセル参照を表す)

## 重要度: 低

- マクロ有効ブック、拡張子.xlsm
- インクリメント`++`やデクリメント`--`が使用できない
- セル内改行: `vbLf`を文字列に連結
- オブジェクト比較: Is関数を使用`オブジェクトA  Is オブジェクトB`
  - 注意: Rangeオブジェクトを取得する場合、その都度セル/セル範囲を扱えるようにしたオブジェクトを生成ため、比較すると`False`が返る
  - `Nothing`: オブジェクトがない場合の返り値
- 値を永続的に保持する
  - 設定用セートを作成してセルに書き込む→シートを非表示
  - `SaveSetting`ステートメントと`GetSetting`関数を利用してレジストリに値を保存
- `Exit Sub`ステートメント: ガード節に使える
- ループ中の処理をスキップ
  - 次ループに遷移する`continue`はない→Ifステートメントで処理
  - `break`の代わり→`Exit for`
- IIF関数: 観光演算子の代わりに使える`IIF(条件式, Trueの処理, Falseの処理)`
