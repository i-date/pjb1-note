# VBAのマクロ実行とイベント

## マクロ実行

1. ユーザーが指定したタイミング
   - マクロダイアログから実行
   - VBEから実行(プロシージャドロップダウンリストボックスなども併用)
   - クイックアクセスバーに登録して実行
   - シート上に配置したボタンから実行
   - ショートカットキーから実行
   - リボンに登録して実行
   - 右クリックメニューに登録して実行
2. ユーザーの任意の操作に応じたタイミング
   - イベント処理を利用（オブジェクトモジュールに記述することが多い）
3. 一定時間ごと
   - 指定秒数後にマクロを実行: `Application.OnTime 実行時間, 実行マクロ`
   - `Application.OnTime Now + TimeValue("00:00:10"), "macro1"`
   - 上記を再帰呼び出し(プロシージャが自身を呼び出す)
   - 注意1: 停止条件を判定するコードが必須
   - 注意2: OnTimeメソッドの最小単位は「1秒」
   - 注意3: OnTimeメソッドで指定したマクロは必ずその時間に実行するわけではない

## イベント

- 一部オブジェクトには、イベントが定義されている
  - Workbook: Open, BeforeClose, BeforeSave
  - Worksheet: Change, SelectionChange, Active, Deactivate
- オブジェクトモジュールにイベントを定義
  - オブジェクトモジュールを選択
  - イベントに応じたイベントプロシージャの雛形を入力
  - 挟まれた部分にコードを記述
